{% extends "layout.html" %}

{% block title %}{{ student.firstname }} {{ student.lastname }} | Reviews{% endblock %}
{% block page %}{{ student.firstname }} {{ student.lastname }} | Reviews{% endblock %}

{{ super() }}
{% block navbar %}
<nav class="purple">
 <div class="nav-wrapper">
   <span class="brand-logo center" style="font-size: 1.5em;">Student Conduct Tracker</span>
   <ul id="nav-mobile" class="left">
     <li>
        <a href="/student_record?student_id={{ student.student_id }}" class="back-button" style="font-size:1.2em; margin-right: 20px;"> <i class="fas fa-arrow-left" style="margin-right: 8px; font-size:1.2em;"></i>Back</a>
     </li>
   </ul>
   <ul id="nav-mobile" class="right">
     <li><a href="/logout" style="font-size:1.2em; margin-right: 20px;">Logout</a></li>
   </ul>
 </div>
</nav>    
{% endblock %}

{% block content %}
<div id="review_student" class="overlay" style="text-align: center;">
  <div class="popup" style="margin: 70px auto;">
    <span class="popup-title">{{ student.firstname }} {{student.lastname}}</span>
    <div class="content">
      <form action="/review_student" method="POST">
        <label for="review-box">Write a review</label><br>
        <input type="hidden" value="{{ student.student_id }}" name="student-id">
        <textarea name="review-text" id="review-box" cols="20" rows="20" style="resize: none;"></textarea>
        <br>
        <label for="rating">Rate {{ student.firstname }} {{student.lastname }}</label>
        <div name="rating">
          <label>
            <input type="radio" class="with-gap" name="rating" value="1" required>
            <span>1 Star</span>
          </label>
          
          <label>
            <input type="radio" class="with-gap" name="rating" value="2">
            <span>2 Stars</span>
          </label>
          
          <label>
            <input type="radio" class="with-gap" name="rating" value="3">
            <span>3 Stars</span>
          </label>
          
          <label>
            <input type="radio" class="with-gap" name="rating" value="4">
            <span>4 Stars</span>
          </label>
          
          <label>
            <input type="radio" class="with-gap" name="rating" value="5">
            <span>5 Stars</span>
          </label>
        </div>
        <div style="margin-top: 20px; display: flex; justify-content: space-between; width: 80%; margin-left: 10%;">
          <a href="#" class="btn waves-effect waves-light" style="border-radius: 10px;" onclick="closePopup()">Cancel</a>
          <button type="submit" class="btn waves-effect waves-light" style="border-radius: 10px;">Add</button>
        </div>
      </form>      
    </div>
  </div>
</div>

<!-- Information -->
<div class="container">
    <div class="row" style="display: flex; align-items: center; padding-top: 20px;">
        <!-- Middle: Full Name and Label -->
        <div class="center-align" style="margin: auto;">
            <h5 style="white-space: nowrap;">{{ student.firstname }} {{ student.lastname }}'s Reviews</h5>
              <span>{{ student.student_id }}</span>
        </div>
    </div>
</div>
<!-- Latest Reviews -->
<div class="container" style="width: 100%; max-width: 1200px; margin: 0 auto;">
    <div class="filter-buttons">
        <button onclick="filterReviews(0)" class="filter-button">All Reviews</button>
        <button onclick="filterReviews(5)" class="filter-button">5 Stars</button>
        <button onclick="filterReviews(4)" class="filter-button">4 Stars</button>
        <button onclick="filterReviews(3)" class="filter-button">3 Stars</button>
        <button onclick="filterReviews(2)" class="filter-button">2 Stars</button>
        <button onclick="filterReviews(1)" class="filter-button">1 Star</button>
        <a class="btn waves-effect waves-light right" href="#review_student" style="border-radius: 10px;">Review Student</a>
    </div>
    <hr>
    <!-- Cards for Latest Reviews -->
    <div id="reviews-container" style="display: grid; grid-template-columns: 1fr; gap: 5px; overflow-y: auto; padding-top: 15px; max-height: 425px;">
        {% for review in student_reviews|reverse %}
            <div class="review-card" data-rating="{{ review.rating }}" style="margin: 10px 0;">
                <div class="card" id="review_card" style="width: 90%;">
                    <div class="card-content">
                        <p>{{ review.text }}</p>
                        <br>
                        <span>Rating:
                            {% for i in range(5) %}
                                {% if i < review.rating %}
                                    <i class="fas fa-star"></i>
                                {% else %}
                                    <i class="far fa-star"></i>
                                {% endif %}
                            {% endfor %}
                        </span>
                        <hr>
                        <span class="card-title" style="font-size: 16px;"><b>Written By:</b> {{ review.reviewer.prefix }} {{ review.reviewer.firstname }} {{ review.reviewer.lastname }}</span>
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>
</div>
{% endblock %}